---
## Front matter
title: "Шаблон отчёта по лабораторной работе"
subtitle: "Лабораторная работа №7.Команды безусловного и условного переходов в Nasm.Программирование ветвлений."
author: "Акрур Имад НКАбд-06-24"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Изучение команд безусловного и условного переходов. Приобретение навыков написания программ с использованием переходов. Ознакомление с назначением и структурой файла листинга.



# Описание результатов выполнения лабораторной работы

##описание выполняемого задания : 

### Реализация переходов в NASM : 

1. Создать  файл lab7-1.asm :

```bash
   touch lab7-1.asm
```
![Создание файла программы lab6-1.asm](/home/imadakrour/Pictures/lab06/1.png){#fig:0001 width=70%}

Каталог создан и подготовлен файл `lab7-1.asm` для записи кода программы. 

2. В файл `lab7-1.asm` введён код программы из листинга 7.1 

**Код программы (Листинг 7.1):**
   
```nasm
   %include 'in_out.asm' ; подключение внешнего файла

   SECTION .data
   msg1: DB 'Сообщение № 1', 0
   msg2: DB 'Сообщение № 2', 0
   msg3: DB 'Сообщение № 3', 0

   SECTION .text
   GLOBAL _start

   _start:
       jmp _label2Лабораторная работа №7.Команды безусловного и
 условного переходов в Nasm.Программирование
 ветвлений.

   _label1:
       mov eax, msg1 ; Вывод на экран строки
       call sprintLF ; 'Сообщение № 1'

   _label2:
       mov eax, msg2 ; Вывод на экран строки
       call sprintLF ; 'Сообщение № 2'

   _label3:
       mov eax, msg3 ; Вывод на экран строки
       call sprintLF ; 'Сообщение № 3'

   _end:
       call quit ; вызов подпрограммы завершения
```

3. Создан исполняемый файл и запущена программа.

![Сборка и запуск программы lab7-1](/home/imadakrour/Pictures/lab07/2.png){#fig:0002 width=70%}


**Команды для сборки и выполнения:** 
   
```bash
   nasm -f elf31  lab7-1.asm
   ld -m elf_i386 -o lab7-1 
   ./lab7-1
```
![Компиляция lab7-1.asm с использованием NASM](/home/imadakrour/Pictures/lab07/3.png){#fig:0003 width=70%}

**Комментарии:**

Использование инструкции `jmp _label2` изменяет порядок исполнения инструкций, пропуская вывод первого сообщения и начиная выполнение программы с метки `_label2`.

**Результат работы программы:**

   ```
   /lab7-1
   Сообщение № 2
   Сообщение № 3

   ```


### Изменение программы для вывода других сообщений

**Описание выполняемого задания:**

Программа изменена так, чтобы она выводила сообщения в следующем порядке: 
1. "Сообщение № 2" 
2. "Сообщение № 1" 
3. Завершение работы. 

**Изменённый код программы :**

```nasm
%include 'in_out.asm' ; подключение внешнего файла

SECTION .data
msg1: DB 'Сообщение № 1', 0
msg2: DB 'Сообщение № 2', 0
msg3: DB 'Сообщение № 3', 0

SECTION .text
GLOBAL _start

_start:
    jmp _label2

_label1:
    mov eax, msg1 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 1'
    jmp _end

_label2:
    mov eax, msg2 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 2'
    jmp _label1

_label3:
    mov eax, msg3 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 3'

_end:
    call quit ; вызов подпрограммы завершения
```

![Изменение программы lab7-1 для изменения порядка вывода](/home/imadakrour/Pictures/lab07/4.png){#fig:0004 width=70%}

**Результат работы программы:**

   ```
   /lab7-1
   Сообщение № 2
   Сообщение № 1

   ```

![Результат выполнения изменённой программы lab7-1](/home/imadakrour/Pictures/lab07/5.png){#fig:0005 width=70%}

**Комментарии:** 

Добавление инструкций `jmp _label1` и `jmp _end` позволяет задать порядок выполнения программы, который отличается от последовательного.



###  использование инструкции jmp _label2 :

так, чтобы она выводила сообщения в следующем порядке: 
1. "Сообщение № 3" 
2. "Сообщение № 2" 
3. "Сообщение № 1"

**Изменённый код программы:** 

```nasm
%include 'in_out.asm' ; подключение внешнего файла

SECTION .data
msg1: DB 'Сообщение № 1', 0
msg2: DB 'Сообщение № 2', 0
msg3: DB 'Сообщение № 3', 0

SECTION .text
GLOBAL _start

_start:
    jmp _label3 ; Переход сразу к выводу "Сообщение № 3"

_label1:
    mov eax, msg1 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 1'
    jmp _end ; Завершение программы

_label2:
    mov eax, msg2 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 2'
    jmp _label1 ; Переход к выводу "Сообщение № 1"

_label3:
    mov eax, msg3 ; Вывод на экран строки
    call sprintLF ; 'Сообщение № 3'
    jmp _label2 ; Переход к выводу "Сообщение № 2"

_end:
    call quit ; Завершение программы
```

![Выполнение lab7-1 с сообщениями в обратном порядке](/home/imadakrour/Pictures/lab07/6.png){#fig:0006 width=70%}

**Команды для сборки и выполнения:** 

```bash
nasm -f elf32  lab7-1.asm
ld -m lf_i386 -o lab7-1 lab7-1.o
./lab7-1
```

![Компиляция и выполнение обновлённой программы lab7-1](/home/imadakrour/Pictures/lab07/7.png){#fig:0007 width=70%}

**Результат работы программы:** 

```
./lab7-1
Сообщение № 3
Сообщение № 2
Сообщение № 1
```


**Комментарии:** 

- Использование инструкций `jmp _label2` и `jmp _label1` позволяет управлять порядком выполнения программы и выводить сообщения в обратном порядке.

###   Программа, которая определяет и выводит на экран наибольшую из 3 целочисленных переменных: A,B и C.

Создать программу, которая определяет наибольшую из трёх целочисленных переменных: `A`, `B` и `C`. 
- Значения `A` и `C` задаются в коде программы. 
- Значение `B` вводится пользователем с клавиатуры. 

![Определение максимума трёх целых чисел в lab7-2](/home/imadakrour/Pictures/lab07/8.png){#fig:0008 width=70%}

**Код программы (Листинг 7.3):** 

```nasm
%include 'in_out.asm'

SECTION .data
msg1 db 'Введите B: ', 0h
msg2 db "Наибольшее число: ", 0h

A dd '20'
C dd '50'

SECTION .bss
max resb 10
B resb 10

SECTION .text
GLOBAL _start

_start:
    ; ---------- Вывод сообщения 'Введите B: '
    mov eax, msg1
    call sprint

    ; ---------- Ввод 'B'
    mov ecx, B
    mov edx, 10
    call sread

    ; ---------- Преобразование 'B' из символа в число
    mov eax, B
    call atoi
    mov [B], eax ; Запись преобразованного числа в 'B'

    ; ---------- Записываем 'A' в переменную 'max'
    mov ecx, [A] ; 'ecx = A'
    mov [max], ecx ; 'max = A'

    ; ---------- Сравниваем 'A' и 'С'
    cmp ecx, [C]
    jg check_B ; Если 'A > C', перейти на 'check_B'
    mov ecx, [C] ; Иначе 'ecx = C'
    mov [max], ecx ; 'max = C'

check_B:
    ; ---------- Преобразование 'max' из символа в число
    mov eax, max
    call atoi
    mov [max], eax

    ; ---------- Сравниваем 'max' и 'B'
    mov ecx, [max]
    cmp ecx, [B]
    jg fin ; Если 'max > B', перейти на 'fin'
    mov ecx, [B] ; Иначе 'ecx = B'
    mov [max], ecx

fin:
    ; ---------- Вывод результата
    mov eax, msg2
    call sprint ; Вывод сообщения 'Наибольшее число: '
    mov eax, [max]
    call iprintLF ; Вывод 'max(A, B, C)'
    call quit ; Завершение программы
```

![Компиляция lab7-2.asm с использованием NASM](/home/imadakrour/Pictures/lab07/9.png){#fig:0009 width=70%}

**Команды для сборки и выполнения:** 

```bash
nasm -f elf -o lab7-2.o lab7-2.asm
ld -o lab7-2 lab7-2.o
./lab7-2
```

![Результат выполнения программы lab7-2, показывающий максимум](/home/imadakrour/Pictures/lab07/10.png){#fig:0010 width=70%}

**Комментарии:** 

- Переменные `A` и `C` задаются в программе. 
- Значение `B` вводится пользователем. 
- Наибольшее значение из трёх переменных определяется с использованием условных переходов (`cmp`, `jg`) и функции `atoi` для преобразования символов в числа. 



**Результаты работы:** 
- При вводе разных значений `B`, программа корректно определяет максимальное из трёх чисел. 


### Создание файла листинга*

1. Для программы `lab7-2.asm` создан файл листинга с помощью следующей команды: 

```bash
nasm -f elf -l lab7-2.lst lab7-2.asm
```

![Создание файла листинга для lab7-2.asm](/home/imadakrour/Pictures/lab07/11.png){#fig:0011 width=70%}

2.   Анализ содержимого файла листинга** 

Открыт файл `lab7-2.lst` в текстовом редакторе: 

```bash
gedit lab7-2.lst
```

![Просмотр сгенерированного файла листинга в текстовом редакторе](/home/imadakrour/Pictures/lab07/12.png){#fig:0012 width=70%}

3. Пример содержимого файла листинга (три строки): 

![Анализ строк файла листинга lab7-2.lst](/home/imadakrour/Pictures/lab07/13.png){#fig:0013 width=70%}

```
1 000000E8 B8[00000000] mov eax, msg1
2 000000ED E81DFFFFFF   call sprint
3 000000F2 B9[0A000000] mov ecx, B
```


**Подробный разбор строк:** 
**Строка 1:** 

```
   1 000000E8 B8[00000000] mov eax, msg1
```
   - **1:** Номер строки из исходного файла программы. 
   - **000000E8:** Смещение (адрес) команды в сегменте кода. 
   - **B8[00000000]** Машинный код команды `mov eax, msg1`. Эта команда загружает адрес сообщения `msg1` в регистр `eax`. 

**Строка 2:** 
```
   2 000000ED E81DFFFFFF   call sprint
```
   - **2:** Номер строки исходного файла. 
   - **000000ED:** Смещение команды в памяти. 
   - **E81DFFFFFF:** Машинный код команды `call sprint`. `E8` — машинный код вызова подпрограммы, а `E81DFFFFFF` — адрес подпрограммы, который будет заполнен на этапе связывания. 

**Строка 3:** 
```
   3 000000F2 B9[0A000000] mov ecx, B
```
   - **3:** Номер строки из исходного файла программы. 
   - **000000F2:** Смещение команды в сегменте. 
   - **B9[0A000000]**: Машинный код команды `mov ecx, [B]`, которая загружает значение переменной `B` в регистр `ecx`. 


3. Удаление операнда и повторное создание листинга: 

В исходном файле `lab7-2.asm` из команды `mov ecx, [B]` удалён один операнд. Команда изменилась на: 

```nasm
mov ecx
```

![Удаление операнд](/home/imadakrour/Pictures/lab07/14.png){#fig:0014 width=70%}

**Трансляция:** 

```bash
nasm -f elf -l lab7-2.lst lab7-2.asm
```

**Результат:** 

1. Файл **lab7-2.o** не создан, так как транслатор обнаружил ошибку. 
2. В файл **lab7-2.lst** добавлено сообщение об ошибке: 

```
   error: instruction expects 2 operands
```
![Ошибка в листинге из-за отсутствия операнда](/home/imadakrour/Pictures/lab07/15.png){#fig:0015 width=70%}

- Листинг дополнен диагностикой, описывающей проблему в строке с неполной инструкцией. 

**Комментарии и выводы:** 

- Файл листинга полезен для отладки, так как он отображает соответствие между исходным кодом, машинным кодом и адресами. 
- При наличии ошибок в исходном коде, NASM добавляет сообщения об ошибках в файл листинга, но не создаёт объектный файл.


## **Выводы по результатам выполнения заданий**

1. Программа с использованием безусловных переходов успешно реализована, демонстрируя изменение порядка выполнения инструкций через команды `jmp`.  
2. Изменённая программа корректно выводит сообщения в заданной последовательности благодаря управлению переходами.  
3. Программа для определения максимального из трёх чисел эффективно использует условные переходы (`cmp`, `jg`), обеспечивая корректный результат.  
4. Генерация и анализ файла листинга показали его полезность для отладки и выявления ошибок в коде.  


# Описание результатов выполнения заданийдля самостоятельной работы


## **описание выполняемого задания**

![вариант номер](/home/imadakrour/Pictures/lab07/16.png){#fig:0016 width=70%}



### Программа нахождения наименьшей из трёх целочисленных переменных**

Написать программу для определения наименьшей из трёх целочисленных переменных \( a, b, c \). 

Значения переменных выбираются из **таблицы 7.5**, для **варианта 3**: 

- \( a = 94 \) 
- \( b = 5 \) 
- \( c = 58 \) 

Код программы:

```nasm
section .data
    msg_min db "Наименьшее число: ", 0h ; Сообщение для вывода результата
    a dd 94                            ; Значение переменной a
    b dd 5                             ; Значение переменной b
    c dd 58                            ; Значение переменной c
section .bss
    min resb 10                        ; Память для результата

section .text
global _start

_start:
    ; ---------- Инициализируем min значением 'a'
    mov eax, [a]
    mov [min], eax

    ; ---------- Сравниваем 'min' с 'b'
    mov eax, [min]
    cmp eax, [b]
    jl check_c         ; Если min < b, перейти на проверку c
    mov eax, [b]
    mov [min], eax

check_c:
    ; ---------- Сравниваем 'min' с 'c'
    mov eax, [min]
    cmp eax, [c]
    jl fin             ; Если min < c, перейти к выводу результата
    mov eax, [c]
    mov [min], eax

fin:
    ; ---------- Выводим результат
    mov eax, msg_min
    call sprint        ; Вывод сообщения
    mov eax, [min]
    call iprintLF      ; Вывод минимального значения

    ; ---------- Завершение программы
    call quit
    
```

![Создание файла программы lab6-3.asm](/home/imadakrour/Pictures/lab07/17.png){#fig:0017 width=70%}

**Команды для сборки и запуска программы:** 

```bash
nasm -f elf32  lab7-3.asm
ld -m elf_i386 -o lab7-3  lab7-3.o
./lab7-3
```

![Результат программы, показывающий минимальное значение](/home/imadakrour/Pictures/lab07/18.png){#fig:0018 width=70%}


**Результаты работы программы:** 

При значениях \( a = 94 \), \( b = 5 \), \( c = 58 \), 

программа выдаёт: 

```
Наименьшее число: 5
```



### Программа вычисления функции \( f(x) \)

![Создание файла программы lab6-4.asm](/home/imadakrour/Pictures/lab07/19.png){#fig:0019 width=70%}

Для введённых с клавиатуры значений \( x \) и \( a \), вычислить значение функции \( f(x) \). 
Функция для **варианта 3** из **таблицы 7.6**: 

$f(x) = \begin{cases} 
3x, & \text{если } x = 3 \\
a + 1, & \text{если } x \neq 3
\end{cases}$

Начальные значения: 
1. \( x_1 = 3, a_1 = 4 \) 
2. \( x_2 = 1, a_2 = 4 \) 

**Код программы:** 

```nasm
section .data
    msg_input_x db "Введите x: ", 0h     ; Сообщение для ввода x
    msg_input_a db "Введите a: ", 0h     ; Сообщение для ввода a
    msg_result db "Результат f(x): ", 0h ; Сообщение для результата

section .bss
    x resb 10    ; Переменная x
    a resb 10    ; Переменная a
    res resb 10  ; Результат f(x)

section .text
global _start

_start:
    ; ---------- Ввод x
    mov eax, msg_input_x
    call sprint         ; Вывод сообщения для вводаЛабораторная работа №7.Команды безусловного и
 условного переходов в Nasm.Программирование
 ветвлений.
    mov ecx, x
    mov edx, 10
    call sread          ; Чтение x
    mov eax, x
    call atoi           ; Преобразование x в число
    mov [x], eax

    ; ---------- Ввод a
    mov eax, msg_input_a
    call sprint         ; Вывод сообщения для ввода
    mov ecx, a
    mov edx, 10
    call sread          ; Чтение a
    mov eax, a
    call atoi           ; Преобразование a в число
    mov [a], eax

    ; ---------- Вычисление f(x)
    mov eax, [x]
    cmp eax, 3          ; Сравнение x с 3
    je equal_x          ; Если x == 3, перейти на equal_x

not_equal_x:
    mov eax, [a]
    add eax, 1          ; Вычисление a + 1
    jmp output_result

equal_x:
    mov eax, [x]
    imul eax, 3         ; Вычисление 3x

output_result:
    mov [res], eax      ; Сохранение результата в res

    ; ---------- Вывод результата
    mov eax, msg_result
    call sprint         ; Вывод сообщения результата
    mov eax, [res]
    call iprintLF       ; Вывод значения f(x)

    ; ---------- Завершение программы
    call quit
```

**Команды для сборки и запуска программы:** 

```bash
nasm -f elf -o lab7-4.asm
ld -o lab7-4 lab7-4.o
./lab7-4
```
![Вывод результата программы для вычисления f(x)](/home/imadakrour/Pictures/lab07/20.png){#fig:0020 width=70%}

**Пример ввода и вывода программы:**

1. При вводе \( x = 3, a = 4 \):

```
   Введите x: 3
   Введите a: 4
   Результат f(x): 9
```

2. При вводе \( x = 1, a = 4 \):

```
   Введите x: 1
   Введите a: 4
   Результат f(x): 5
```



## Выводы по результатам выполнения самостоятельной работы

1. Программа для нахождения наименьшего числа успешно реализована и корректно определяет минимальное значение из трёх целых чисел.
2. Программа для вычисления функции \( f(x) \) корректно обрабатывает входные данные и вычисляет результат в зависимости от условия \( x = 3 \) или \( x \neq 3 \).

# **Выводы**

1. Работа успешно выполнена, продемонстрированы навыки использования безусловных и условных переходов в NASM.  
2. Реализованы программы для управления порядком выполнения инструкций, нахождения максимума и минимума, а также вычисления функции \( f(x) \).  
3. Генерация и анализ файла листинга укрепили понимание структуры программ на ассемблере и инструментов отладки.  


